# Google Sheets操作自動化のための準備：サービスアカウントの作成手順

このガイドでは、AIエージェント（Antigravityなど）を使ってGoogleスプレッドシートを操作するために必要な「サービスアカウント」の作成方法を、初心者向けにステップバイステップで解説します。

---

## 手順概要

1. Google Cloudプロジェクトの作成
2. Google Sheets APIの有効化
3. サービスアカウントの作成とキーの発行
4. スプレッドシートへの共有設定

---

## 1. Google Cloudプロジェクトの作成

まず、Google Cloud Platform (GCP) コンソールにアクセスし、作業用のプロジェクトを作成します。

1. [Google Cloud Console](https://console.cloud.google.com/) にアクセスします。
2. 画面左上のプロジェクト選択プルダウンをクリックします。
3. ポップアップ画面右上の **「新しいプロジェクト」** をクリックします。
4. **「プロジェクト名」** を入力します（例: `automated-sheets-access` など、分かりやすい名前）。
5. **「作成」** をクリックします。
   * ※ 作成完了まで数秒〜数分かかる場合があります。通知ベルアイコンで完了を確認し、作成したプロジェクトを選択してください。

## 2. Google Sheets APIの有効化

作成したプロジェクトで、スプレッドシートを操作するためのAPIを有効にします。

1. 左側のナビゲーションメニュー（三本線アイコン）から **「APIとサービス」 > 「ライブラリ」** を選択します。
2. 検索バーに `Google Sheets API` と入力して検索します。
3. 検索結果から **「Google Sheets API」** をクリックします。
4. **「有効にする」** ボタンをクリックします。

## 3. サービスアカウントの作成とキーの発行

AIエージェントが人間の代わりに操作を行うための「ロボット用アカウント（サービスアカウント）」を作成し、認証用の鍵（JSONファイル）を取得します。

1. 左側のナビゲーションメニューから **「APIとサービス」 > 「認証情報」** を選択します。
2. 上部の **「+ 認証情報を作成」** をクリックし、**「サービスアカウント」** を選択します。
3. **サービスアカウントの詳細**を入力します：
   - **サービスアカウント名**: 任意の名前（例: `sheets-editor`）。
   - **「作成して続行」** をクリックします。
4. **ロールの選択**（省略可能ですが推奨）：
   - 「ロールを選択」プルダウンから **「基本」 > 「編集者」** を選択しておくとスムーズです。
   - **「続行」** をクリックし、次の画面で **「完了」** をクリックします。
5. 作成されたサービスアカウント（メールアドレスのような形式のもの）が一覧に表示されます。その行の右側にある **鉛筆アイコン（編集）** またはメールアドレスをクリックします。
6. 上部のタブから **「キー」** を選択します。
7. **「鍵を追加」 > 「新しい鍵を作成」** をクリックします。
8. キーのタイプで **「JSON」** が選択されていることを確認し、**「作成」** をクリックします。
9. **JSONファイルが自動的にダウンロードされます。**
   * **重要**: このファイルはパスワードそのものです。他人に渡したり、公開場所にアップロードしないよう厳重に管理してください。
   * **保存場所の変更**: このファイルを、ユーザーフォルダ直下の `.gemini` フォルダの中に移動し、`credentials.json` という名前に変更してください。
     * 保存先例: `C:\Users\あなたのユーザー名\.gemini\credentials.json`
     * ※ `.gemini` フォルダがない場合は作成してください。ここに置くことで、どのプロジェクトからでも共通して使えるようになります。

## 4. スプレッドシートへの共有設定

最後に、操作したい実際のスプレッドシートに、作成したサービスアカウントを招待します。これを忘れると「権限がありません（403エラー）」になります。

1. 手順3-5で確認した **サービスアカウントのメールアドレス** （例: `sheets-editor@project-id.iam.gserviceaccount.com`）をコピーします。
2. 操作したいGoogleスプレッドシートを開きます。
3. 右上の **「共有」** ボタンをクリックします。
4. 「ユーザーやグループを追加」の欄に、コピーした **サービスアカウントのメールアドレス** を貼り付けます。
5. 権限が **「編集者」** になっていることを確認し、**「送信」** をクリックします。
   * ※「Googleアカウントを持たないユーザーに招待を送信しますか？」と聞かれた場合は「共有する」を選択してください。

---

以上で準備は完了です！
ダウンロードしたJSONキーファイルを使って、AIエージェントからスプレッドシートを読み書きできるようになります。
