# AIエージェントにExcel操作を依頼しよう

このガイドでは、AIエージェント（ChatGPTやClaude、Copilotなど）を使って、PythonでExcelファイルを操作するための指示の出し方（プロンプト）を解説します。
難しいプログラミングコードを書く必要はありません。AIに「やりたいこと」を正しく伝えれば、コードはAIが書いてくれます。

---

## 準備：Python環境

AIにコードを書いてもらう前に、そのコードを実行するための準備だけは必要です。

1. **Pythonのインストール**: （`01_setup_environment.md` 参照）
2. **ライブラリのインストール**:
   AIに以下のようにお願いするか、自分でコマンドを実行して `openpyxl` をインストールします。

   **AIへの依頼例:**
   > PythonでExcelを操作したいので、必要なライブラリ（openpyxlなど）をインストールするコマンドを教えて。

---

## AIエージェントへの依頼のコツ

AIにExcel操作を頼むときは、以下の3点を伝えるとスムーズです。

1. **入力ファイル**: どのファイルを読み込むか（ファイル名、シート名）
2. **やりたいこと**: データをどう加工したいか、何を抽出したいか
3. **出力ファイル**: 結果をどのファイルに保存するか（上書きか、別名保存か）

以下に、よくある操作の依頼例を紹介します。

---

## パターン1: 新しいExcelファイルを作りたい

Excelファイルが存在しない状態から、新しくデータを作成する場合です。

### 依頼プロンプトの例

> Pythonで、新しいExcelファイル `売上管理表.xlsx` を作成するコードを書いてください。
>
> **要件:**
> - シート名は「2024年4月」にしてください。
> - A1セルに「日付」、B1セルに「商品名」、C1セルに「価格」という見出しを入れてください。
> - 以下のサンプルデータを3行ほど追加してください。
>   - 4/1, りんご, 100
>   - 4/2, バナナ, 150
>   - 4/3, みかん, 80

---

## パターン2: 既存のファイルを読み込んで集計したい

すすでにあるExcelファイルを開いて、計算や分析を行いたい場合です。

### 依頼プロンプトの例

> `売上管理表.xlsx` というExcelファイルがあります。
> Pythonでこのファイルを読み込んで、C列（価格）の合計金額を計算するコードを書いてください。
> 結果は画面に表示するだけでOKです。

---

## パターン3: ファイルを編集して保存したい

特定の部分だけ書き換えたり、計算結果を追記して保存する場合です。

### 依頼プロンプトの例

> `売上管理表.xlsx` の「2024年4月」シートを読み込んで以下の処理を行ってください。
>
> 1. D1セルに「個数」という見出しを追加する。
> 2. データ行（2行目以降）のD列に、すべて「1」と入力する。
> 3. 編集した内容を `売上管理表_更新済み.xlsx` という別の名前で保存するコードを書いてください。

---

## うまくいかないときは？

エラーが出たり、思った通りの結果にならないときは、そのままAIに相談しましょう。

- **エラーが出た場合**:
  エラーメッセージをそのままコピーして、「このエラーが出ました。どうすれば直りますか？」と聞く。
- **データがずれている場合**:
  「1行目がヘッダー（見出し）なのですが、2行目から処理するように修正してください」と具体的に伝える。

AIは「優秀な新人アシスタント」のようなものです。
少し丁寧すぎるくらい具体的に指示を出すと、完璧な仕事をしてくれます！
