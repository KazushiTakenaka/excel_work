# Python環境構築ガイド

このガイドでは、GoogleスプレッドシートやExcelをプログラム（Python）から操作するための環境構築手順を説明します。
プログラミング初心者の方でも進められるよう、Pythonのインストールからライブラリのセットアップまでを解説します。

---

## 1. Pythonのインストール

まずはご自身のパソコンにPython（パイソン）をインストールします。

### Windowsの場合

1. **Python公式サイトへアクセス**
   - [Python Downloads for Windows](https://www.python.org/downloads/windows/) にアクセスします。
   - "Latest Python 3 Release - Python 3.x.x" をクリックします（特に理由がなければ最新の安定版でOKです）。
   - ページ下部の Files セクションから **「Windows installer (64-bit)」** をダウンロードします。

2. **インストーラーの実行**
   - ダウンロードしたファイル（例: `python-3.12.0-amd64.exe`）をダブルクリックして起動します。
   - **重要**: 画面下部にある **「Add python.exe to PATH」** というチェックボックスに**必ずチェックを入れてください**。これを行わないと、コマンドラインからPythonを使えません。
   - **「Install Now」** をクリックしてインストールを開始します。
   - "Setup was successful" と表示されたら「Close」をクリックします。

3. **インストールの確認**
   - スタートメニューから「PowerShell」または「コマンドプロンプト」を開きます。
   - 以下のコマンドを入力してEnterキーを押します。
     ```powershell
     python --version
     ```
   - `Python 3.12.0` のようにバージョン番号が表示されれば成功です。

---

## 2. プロジェクトフォルダと仮想環境の作成

Pythonで開発を行う際は、プロジェクトごとに「仮想環境」を作るのが一般的です。
これを使うと、プロジェクトごとに別々のライブラリを管理の箱を用意でき、他のツールと不具合が起きるのを防げます。
**少し難しそうに聞こえますが、以下の手順通りにやれば簡単です！**

1. **プロジェクトフォルダの作成**
   - デスクトップなど、分かりやすい場所にフォルダを作成します（例: `excel_automation`）。

2. **PowerShellでフォルダを開く**
   - 作成したフォルダを `Shift` キーを押しながら **右クリック** します。
   - メニューから **「PowerShell ウィンドウをここで開く」** （または「ターミナルで開く」）を選択します。

3. **仮想環境の作成**
   - 開いた画面で以下のコマンドを入力し、Enterキーを押します。
     ```powershell
     python -m venv venv
     ```
   - フォルダの中に `venv` という新しいフォルダが自動的に作られます。これが仮想環境の箱です。

4. **仮想環境の有効化**
   - 続けて以下のコマンドを入力し、Enterキーを押します。
     ```powershell
     .\venv\Scripts\activate
     ```
   - 重要: 画面の左端に `(venv)` という文字が表示されれば成功です！
   - ※もしエラーが出る場合は、以下のコマンドを実行してからもう一度試してください。
     ```powershell
     Set-ExecutionPolicy RemoteSigned -Scope CurrentUser
     ```

---

## 3. 必要なライブラリのインストール

仮想環境が有効になっている状態（左端に `(venv)` がある状態）で、必要なライブラリをインストールします。

今回は以下のライブラリを使用します。
- `gspread`: Googleスプレッドシートを操作するため
- `oauth2client`: Googleの認証を行うため
- `pandas`: データの加工やExcelの操作を行うため
- `openpyxl`: Excelファイル（.xlsx）の読み書きを行うため

### インストール手順

PowerShellで以下のコマンドを実行してください。

```powershell
pip install gspread oauth2client pandas openpyxl
```

これで、このプロジェクト専用の「道具箱」にライブラリが入りました。

---

## 【おすすめ】 setup.bat（自動セットアップツール）を使う場合

もっと簡単に環境を作りたい方のために、自動で環境構築を行うツール「**setup.bat**」を用意しました。
これを使えば、手順2〜3（仮想環境の作成とライブラリのインストール）をダブルクリックだけで完了できます。

1. `setup.bat` をダウンロードまたは作成し、プロジェクトフォルダに置きます。
2. `setup.bat` をダブルクリックして実行します。
3. 黒い画面が表示され、自動的にインストールが進みます。
   - ※途中で「Python is not installed...」と出たら、手順1のPythonインストールを行ってください。
   - 「Setup Completed Successfully!」と表示されたら成功です。

このツールを使えば、難しいコマンド入力は不要です！

---

## 4. 次のステップ

これでプログラミングを始める環境の準備が完璧に整いました！
このフォルダ（`excel_automation`）の外（`.gemini`フォルダ）に**共通のキーファイル**を置き、このフォルダ内には **Pythonのプログラム** を保存していきます。

次はGoogle Cloudでの設定を行い、キーファイルを取得して所定の場所に保存しましょう。
